# Node.js

> Node.js®는 Chrome V8 JavaScript 엔진으로 빌드된 JavaScript 런타임입니다. Node.js는 이벤트 기반, 논블로킹 I/O 모델을 사용해 가볍고 효율적입니다. Node.js의 패키지 생태계인 npm은 세계에서 가장 큰 오픈 소스 라이브러리 생태계이기도 합니다. 

## 1. 서버

노드를 이용해 다양한 자바스크립트 애플리케이션을 실행할 수 있는데, 특히 서버 애플리케이션을 실행하는데 가장 많이 사용한다.  
**서버는 네트워크를 통해 클라이언트에 정보나 서비스를 제공하는 컴퓨터 또는 프로그램을 말한다.**

- 클라이언트: 요청을 보내는 주체(브라우저, 데스크톱 프로그램, 모바일 앱 또는 다른 서버에 요청을 보내는 서버)
- 서버: 클라이언트의 요청에 대한 응답을 하거나 또다른 서버에 요청을 보냄

### 1.2. 자바스크립트 런타임

특정 언어로 만든 프로그램들을 실행할 수 있는 환경  
노드는 자바스크립트 프로그램을 컴퓨터에서 실행할 수 있게 함

구글의 V8 엔진은 기존에 속도 문제로 인터넷 브라우저에서만 실행할 수 있었던 자바스크립트를 빠르게 실행할 수 있는 자바스크립트 엔진이며, 오픈소스로 코드도 공개되었다.

2009년 라이언 달은 V8 엔진 기반의 노드 프로젝트를 시작했다.   
V8과 함께 노드에서 사용되는 **libuv라는 라이브러리**는 노드의 특성인 **이벤트 기반, 논블로킹 I/O 모델**을 구현하고 있다.

### 1.2 이벤트 기반(event-driven)

이벤트(클릭, 네트워크 요청 등)가 발생할 때 미리 지정해둔 작업을 수행하는 방식  

특정 이벤트가 발생할 때 무엇을 할 지 미리 등록한다.  
이벤트 리스너(event listner)에 콜백(callback)함수를 등록한다.

발생한 이벤트가 없거나 발생했던 이벤트를 다 처리하면 노드는 다음 이벤트가 발생할 때까지 대기한다.

#### 이벤트 루프
+ 이벤트 발생 시 호출할 콜백 함수들을 관리
+ 호출된 콜백 함수의 실행 순서를 결정
+ 종료될 때까지 이벤트 처리를 위한 작업을 반복

#### 태스크 큐
+ 이벤트 발생 후 호출되어야 할 콜백 함수들이 기다리는 공간
+ 콜백들이 이벤트 루프가 정한 순서대로 줄을 서 있다.(콜백 큐라고도 부름)

#### 백그라운드 
+ 타이머나 I/O 작업 콜백 또는 이벤트 리스너들이 대기하는 곳

#### 실행 환경(실행 컨텍스트)
+ 함수가 호출되었을 때 생성되는 환경

+ [이벤트 루프 시각적 설명](http://latentflip.com/loupe/)
+ [이벤트 루프란?](https://nodejs.org/ko/docs/guides/event-loop-timers-and-nexttick/)

Node.js는 이벤트 기반, 논블로킹 I/O(입출력) 모델을 사용

### 1.4. 논블로킹

이전 작업이 완료될 때까지 멈추지 않고 다음 작업을 수행함, 비동기와 유사

※ 싱글 스레드라는 한계 때문에 자바스크립트의 모든 코드가 이 방식으로 시간적 이득을 볼 수 있는 것은 아니다.  
노드 프로세스 외의 다른 컴퓨팅 자원을 사용할 수 있는 I/O 작업이 주로 시간적 이득을 많이 본다.

#### I/O(Input/Ouput)

입력/출력, 파일 시스템 접근(CRUD)이나 네트워크 요청같은 작업이 I/O의 일종.  
이러한 작업을 할 때 노드는 논블로킹 방식으로 동작한다.

### 1.5. 싱글 스레드

컴퓨터 작업을 처리할 수 있는 일 손. 싱글스레드란 주어진 작업을 혼자 처리해야 함을 의미한다.  
반면에 멀티 스레드인 시스템에서는 여러 개의 스레드가 일을 나눠서 처리한다. 

+ 프로세스
  - 운영체제에서 할당하는 작업의 단위. 
  - 노드나 인터넷 브라우저 같은 프로그램은 개별적인 프로세스  
  - 프로세스 간에는 메모리 등의 자원을 공유하지 않는다.
+ 스레드
  - 프로세스 내에서 실행되는 흐름의 단위
  - 하나의 프로세스는 스레드를 여러개 가질 수 있다.
  - 스레드들은 부모 프로세스의 자원을 공유한다.(같은 메모리에 접근할 수 있다.)

노드 프로세스는 내부적으로 스레드를 여러 개 가지고 있지만, 우리가 직접 제어할 수 있는 스레드는 하나뿐이므로 흔히 싱글 스레드라고 부른다.  
노드는 스레드를 늘리는 대신, 프로세스 자체를 복사해 여러 작업을 동시에 처리하는 멀티 프로세싱 방식을 택했다.